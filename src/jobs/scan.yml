description: >
  This job will run security scanners based off the config in your sken.yaml file.
  Before running this orb, you must login to our dashboard (https://dashboard.sken.ai) to obtain your org and app id.
  Once done, create a sken.yaml in the root directory. You may then run this job.
  For more information: http://docs.sken.ai/en/articles/4340878-quickly-get-started-with-sken-setup-sken-in-your-ci-cd
  This job will always succeed regardless of the results of the scan.
  Return to our dashboard portal to analyze the results.
# What will this job do?
# Descriptions should be short, simple, and clear.

machine:
  image: circleci/classic:201808-01

steps:

  - checkout

  - run:
      name: Update pyenv
      command: |
        # Install pyenv-update to allow addition of python 3.7.0
        git clone git://github.com/pyenv/pyenv-update.git $(pyenv root)/plugins/pyenv-update
        pyenv update
        pyenv install 3.6.9

  - run:
      name: Set Python Version
      command: pyenv global 3.6.9

  - run:
      name: Install skencli
      command: pip install --upgrade skencli

  - run:
      name: Scan
      command: skencli
